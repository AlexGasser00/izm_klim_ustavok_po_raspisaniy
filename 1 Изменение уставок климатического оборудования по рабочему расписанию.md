---
{}
---

### Входные переменные

current_time – текущее время. work_time_start – время начала рабочего расписания. work_time_end – время окончания рабочего расписания. Tset_work – стандартная уставка температуры для рабочего времени (°C). Tset_off – уставка температуры для нерабочего времени (°C). Override_timer – таймер хранения ручной уставки во внерабочее время (ч). По умолчанию 2 часа Tset_manual – ручная уставка температуры (°C).

### Выходные переменные

Tset_current – активная уставка температуры (°C). Tset_Override – флаг ручного изменения уставки резидентами (0/1).

### Логика работы

Проверяем: work_time_start ≤ current_time \< work_time_end? Да -> рабочее время. Нет -> нерабочее время.

Рабочее время: По умолчанию: Tset_current = Tset_work, Tset_Override = 0. Если резиденты изменили уставку: Устанавливается Tset_current = новое значение. Tset_Override = 1. Сохраняем до конца рабочего времени.

Нерабочее время:

По умолчанию: Tset_current = Tset_off, Tset_Override = 0. Если резиденты изменили уставку: Устанавливается Tset_current = Tset_manual Tset_Override = 1. Запускается Override_timer = 2ч. Если Override_timer > 0 -> продолжаем использовать пользовательскую уставку. Если Override_timer истёк -> сбрасываем на Tset_current = Tset_off, Tset_Override = 0.

При наступлении нового рабочего дня (в момент work_time_start): Всегда сбрасываем уставку на Tset_work. Tset_Override = 0.

### Блок-схема

[drawio:./1 Изменение уставок климатического оборудования по рабочему расписанию.svg::211px:101px]